<!DOCTYPE html>
<html ng-app = "newTab" ng-csp>

    <head>
        <title>New tab</title>
        <link rel="stylesheet" type="text/css" href="../css/angular-csp.css"/>
        <link rel="stylesheet" type="text/css" href="../css/bootstrap.css"/>
        <!--<link rel="stylesheet" type="text/css" href="../css/bootstrap.css.map"/>-->

        <script src = "../libs/angular.js"></script>
        <script src = "../libs/angular-sanitize.js"></script>
        <script src = "../libs/ui-bootstrap-tpls-0.12.0.js"></script>
        <script src = "../libs/URL.js"></script>

        <script src = "../page_scripts/utils.js"></script>
        <script src = "../page_scripts/listened_data.js"></script>
        <script src = "../page_scripts/black_list.js"></script>
        <script src = "../page_scripts/history.js"></script>
        <script src = "../page_scripts/newTab.js"></script>
        <script src = "../page_scripts/domains_bar_ctrl.js"></script>
        <script src = "../page_scripts/url_bar_ctrl.js"></script>
        <!--Bookmarks part-->
        <!--<script type = "text/ng-template" id = "bookmark_dialog_small.html" src = "bookmark_dialog_small.html"></script>-->
        <!--<script type = "text/ng-template" id = "bookmark_dialog_large.html" src = "bookmark_dialog_large.html"></script>-->
        <script src = "../page_scripts/bookmarks_small_ctrl.js"></script>
        <script src = "../page_scripts/bookmarks_large_ctrl.js"></script>
        <script src = "../page_scripts/bookmarks.js"></script>

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    </head>

    <body ng-controller = "newTabCtrl">
        <div class = "header">
            <button class = "historyRequest" ng-click = "updateHistory(0)">All time</button>
            <button class = "historyRequest" ng-click = "updateHistory(30)">30 days</button>
            <button class = "historyRequest" ng-click = "updateHistory(60)">60 days</button>
            <button ng-click="doBookmark()">ds</button>
        </div>
        <table>
            <td></td>
            <td>
                <div ng-controller="domainsBarCtrl" class = "domainsContainer">
                    <div class = "domainItem" ng-repeat = "domain in domainsList.data">
                        {{domain.visitCount}}
                        <button ng-click = "expandedDomains[domain.name] = !expandedDomains[domain.name]">+</button>
                        <a href = "{{domainToURL(domain.name)}}">{{shortString(domainToShort(domain.name))}}</a>
                        <button class = "bookmark" ng-click = "doBookmark(domainToURL(domain.name))">☆</button>
                        <button class = "remove" ng-click = "addDomainToBlackList(domain.name)">x</button>
                        <div class = "urlItems" ng-show = "expandedDomains[domain.name]">
                            <div class = "urlItem" ng-repeat = "url in domain.urls">
                                {{url.visitCount}}
                                <a ng-href = "{{url.url}}">{{shortString(url.url)}}</a>
                                <button class = "bookmark" ng-click = "addToBookmark(url.url)">☆</button>
                                <button class = "remove" ng-click = "addURLToBlackList(url.url)">x</button>
                            </div>
                        </div>
                    </div>
                </div>
            </td>
            <td>
                <div ng-controller="urlBarCtrl" class = "urlsContainer">
                    <div class = "urlItem" ng-repeat = "url in urlList.data">
                        {{url.visitCount}}
                        {{shortString(url.title)}}
                        <a href = "{{url.url}}">{{shortURL(url.url)}}</a>
                        <button class = "bookmark" ng-click = "addToBookmark(url.url)">☆</button>
                        <button class = "remove" ng-click = "addToBlackList(url.url)">x</button>
                    </div>
                </div>
            </td>
        </table>

    </body>

</html>